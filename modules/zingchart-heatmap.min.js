/*
All of the code within the ZingChart software is developed and copyrighted by ZingChart, Inc., and may not be copied,
replicated, or used in any other software or application without prior permission from ZingChart. All usage must coincide with the
ZingChart End User License Agreement which can be requested by email at support@zingchart.com.

Build 2.9.15
*/
zingchart.setModule("heatmap"),function(){var v,r,l;zingchart.plugins.heatmap=zingchart.plugins.heatmap||{},ZC.ZCHeatMap||(v={},ZC.ZCHeatMap=function(){this.AB="canvas",this.I=0,this.F=0,this.aDataInit=null,this.aData=[],this.oKVData={},this.aSize=[15,15],this.iBlur=45,this.KU=!1,this.A7=null,this.bComposite=!0,this.aGradient=[[.4,"#0000ff"],[.6,"#00ffff"],[.7,"#bfff00"],[.8,"#ffff00"],[1,"#ff0000"]],this.oGradientData=null,this.oBrush=null,this.sBrushType="circle",this.sBrushInfo=null,this.bSortData=!1,this.addData=function(t){this.aData.push(t)},this.setData=function(t,a){if(this.AAX&&-1===a.indexOf("scatter"))for(var e=0,i=t.length;e<i;e++)this.oKVData[t[e][0]+"/"+t[e][1]]=t[e][2];this.aData=t,this.aDataInit||(this.aDataInit=t),this.bSortData&&this.aData.sort(function(t,a){return t[2]-a[2]})},this.B0=null,this.BF=null,this.C5=.5,this.Z=null,this.AAX=null,this.setMinMax=function(){if(null===this.B0||null===this.BF)for(var t=0,a=this.aData.length;t<a;t++)this.B0=Math.min(this.B0,this.aData[t][2]),this.BF=Math.max(this.BF,this.aData[t][2])},this.createGradient=function(){var t=document.createElement("canvas"),a=t.getContext("2d"),e=a.createLinearGradient(0,0,0,256);t.width=1,t.height=256;for(var i=0;i<this.aGradient.length;i++)e.addColorStop(this.aGradient[i][0],this.aGradient[i][1]);a.fillStyle=e,a.fillRect(0,0,1,256),this.oGradientData=a.getImageData(0,0,1,256).data},this.createBrush=function(){var t=document.createElement("canvas"),a=t.getContext("2d");"circle"===this.sBrushType?t.width=t.height=2*(this.aSize[0]+this.iBlur):"square"===this.sBrushType?t.width=t.height=this.aSize[0]+2*this.iBlur:"rectangle"===this.sBrushType&&(t.width=this.aSize[0]+2*this.iBlur,t.height=this.aSize[1]+2*this.iBlur),a.shadowOffsetX=a.shadowOffsetY=200,a.shadowBlur=this.iBlur,a.shadowColor="#000","circle"===this.sBrushType?(a.beginPath(),a.arc(this.aSize[0]+this.iBlur-200,this.aSize[0]+this.iBlur-200,this.aSize[0],0,2*Math.PI,!0),a.closePath(),a.fill()):"square"===this.sBrushType?a.fillRect(this.iBlur-200,this.iBlur-200,this.aSize[0],this.aSize[0]):"rectangle"===this.sBrushType&&a.fillRect(this.iBlur-200,this.iBlur-200,this.aSize[0],this.aSize[1]),this.oBrush=t},this.reset=function(){this.aData=this.aDataInit},this.paint=function(){var o,c;if(this.aData.length){this.UID=this.UID?++this.UID:1;var u=this.Z.getContext("2d"),d=this,t=null;if(!this.AAX||(t=(a=zingchart.getLoader(this.AAX.loaderid))?zingchart.getGraph(a,this.AAX[ZC._[3]]):t)){if(this.AAX){var a=zingchart.exec(this.AAX.loaderid,"getobjectinfo",{graphid:this.AAX[ZC._[3]],object:"plotarea"}),a=(a&&(u.beginPath(),u.rect(a.x-t.iX,a.y-t.iY,a.width,a.height),u.clip(),u.closePath()),zingchart.exec(this.AAX.loaderid,"getobjectinfo",{object:"scale",name:this.AAX.keyscale.name,graphid:this.AAX[ZC._[3]]})),e=zingchart.exec(this.AAX.loaderid,"getobjectinfo",{object:"scale",name:this.AAX.valscale.name,graphid:this.AAX[ZC._[3]]});if(a&&e){var i,s,h,n,g,r=(a.step+"").split("."),r=(this.AAX.keyscale.decimals=2===r.length?r[1].length:0,(e.step+"").split(".")),l=(this.AAX.valscale.decimals=2===r.length?r[1].length:0,[]),f=[],p=("xy"===t.AJ.layout?-1===t.AF.indexOf("scatter")&&(this.aSize=[Math.ceil(a.stepSize)+.5,Math.ceil(e.stepSize)+.5]):"radar"===t.AJ.layout&&(f=[a.x+a.width/2,a.y+a.height/2]),t.BM(this.AAX.keyscale.name)),C=t.BM(this.AAX.valscale.name),m=[],Z={},A=1;for(-1!==t.AF.indexOf("scatter")&&1e5<this.aData.length&&(r=Math.max((p.BF-p.B0)/(p.V[p.V.length-1]-p.V[0]),(C.BF-C.B0)/(C.GW-C.FQ)),A=Math.max(1,Math.round(5*r))),o=0,c=this.aData.length;o<c;o++)(g=this.aData[o])[0]>=p.B0&&g[0]<=p.BF&&g[1]>=C.B0&&g[1]<=C.BF&&(h=p.AR(g[0]),n=C.AR(g[1]),"radar"===t.AJ.layout?(h[0]-=t.iX,h[1]-=t.iY,n[0]-=t.iX,n[1]-=t.iY,i=180*Math.atan2(h[1]-f[1],h[0]-f[0])/Math.PI,s=f[1]-n[1]+e.offsetStart,s=ZC.AQ.BN(f[0],f[1],s,i),l.push([s[0],s[1],g[2],g[3]])):(h-=t.iX,n-=t.iY,l.push([h,n,g[2],g[3]]),-1!==t.AF.indexOf("scatter")&&(1<A?Z[A*Math.round(h/A)+"/"+A*Math.round(n/A)]=g:Z[Math.round(h)+"/"+Math.round(n)]=g)));if(-1!==t.AF.indexOf("scatter")){for(var B in Z){var v=B.split("/");m.push({x:parseFloat(v[0]),y:parseFloat(v[1]),key:Z[B][0],val:Z[B][1],v:Z[B][2],info:Z[B][3]})}this.oKDTree=new ZC.ZCKDTree(m)}this.aData=l}}this.oGradientData||this.createGradient(),this.sBrushInfo||(this.sBrushInfo=[this.sBrushType,this.aSize[0],this.aSize[1]].join("-")),this.oBrush&&this.sBrushInfo===[this.sBrushType,this.aSize[0],this.aSize[1]].join("-")||(this.createBrush(),this.sBrushInfo=[this.sBrushType,this.aSize[0],this.aSize[1]].join("-")),this.setMinMax(),u.clearRect(0,0,d.I,d.F);var x=this.KU?25:1,_=function(){var t=u.getImageData(0,0,d.I,d.F);u.clearRect(0,0,d.I,d.F);for(var a=3,e=t.data.length;a<e;a+=4)t.data[a]/=1/d.C5;u.putImageData(t,0,0),d.Z.style.opacity="1","svg"===d.AB&&ZC.AL(d.Z.id.replace(/\-c$/,"-img")).setAttribute("href",d.Z.toDataURL())},y=this.UID,D=function(t,a,e){for(o=t;o<a;o++){var i,s,h,n;(g=d.aData[o])&&(i=1,d.B0!==d.BF&&(i=Math.max((g[2]-d.B0)/(d.BF-d.B0),.01)),d.AAX&&!d.bComposite?(n=4*Math.floor(255*i),s=d.oGradientData[n],h=d.oGradientData[1+n],n=d.oGradientData[2+n],u.fillStyle="rgb("+s+","+h+","+n+")","circle"===d.sBrushType?(u.beginPath(),u.arc(g[0],g[1],d.aSize[0],0,2*Math.PI),u.fill(),u.closePath()):u.fillRect(g[0]-d.aSize[0]/2,g[1]-d.aSize[1]/2,d.aSize[0],d.aSize[1])):(u.globalAlpha=i,"circle"===d.sBrushType?u.drawImage(d.oBrush,g[0]-d.aSize[0]-d.iBlur,g[1]-d.aSize[0]-d.iBlur):"square"===d.sBrushType?u.drawImage(d.oBrush,g[0]-d.aSize[0]/2-d.iBlur,g[1]-d.aSize[0]/2-d.iBlur):"rectangle"===d.sBrushType&&u.drawImage(d.oBrush,g[0]-d.aSize[0]/2-d.iBlur,g[1]-d.aSize[1]/2-d.iBlur)))}if(!d.AAX||d.bComposite){var r=u.getImageData(0,0,d.I,d.F);for(o=3,c=r.data.length;o<c;o+=4){var l=4*r.data[o];l&&(r.data[o-3]=d.oGradientData[l],r.data[o-2]=d.oGradientData[1+l],r.data[o-1]=d.oGradientData[2+l])}u.putImageData(r,0,0)}a=Math.min(d.aData.length,a+Math.round(d.aData.length/x)),t=Math.min(d.aData.length,t+Math.round(d.aData.length/x)),d.UID===y&&(!e&&d.KU?("svg"===d.AB&&ZC.AL(d.Z.id.replace(/\-c$/,"-img")).setAttribute("href",d.Z.toDataURL()),window.setTimeout(function(){D(t,a,a>=d.aData.length)},1)):_())};this.aData.length&&D(0,Math.round(this.aData.length/x))}}},this.clear=function(){this.aData=[]}},zingchart.bind(null,"postzoom",function(t){if(r)l(t),r=!1;else{var a=zingchart.getLoader(t.id),t=zingchart.getModules(a);if(-1!==ZC.AV(t,"heatmap"))for(var e=0,i=a.AG.length;e<i;e++){var s=a.AG[e];s.o.heatmap&&((s=v[a.K+"-"+s.L]).reset(),s.paint())}}}),zingchart.bind(null,ZC._[48],function(t){var a=zingchart.getLoader(t.id),e=zingchart.getModules(a);if(-1!==ZC.AV(e,"heatmap"))for(var i=0,s=a.AG.length;i<s;i++){var h=a.AG[i];if(h.o.heatmap&&ZC.DS(t.x,h.iX,h.iX+h.I)&&ZC.DS(t.y,h.iY,h.iY+h.F)){var n=v[a.K+"-"+h.L],r=null;if(n){var l,o="",c="",u=null;if(-1===h.AF.indexOf("scatter"))if(n.AAX&&!n.bComposite){if(ZC.DS(t.x,h.P.iX,h.P.iX+h.P.I)&&ZC.DS(t.y,h.P.iY,h.P.iY+h.P.F)){for(var d=zingchart.exec(t.id,"getxyinfo",{x:t.x,y:t.y}),g=0;g<d.length;g++)d[g][ZC._[3]]===n.AAX[ZC._[3]]&&("key-scale"===d[g].infotype&&(o=d[g].scalevalue.toFixed(n.AAX.keyscale.decimals)),"value-scale"===d[g].infotype)&&(c=d[g].scalevalue.toFixed(n.AAX.valscale.decimals));r=n.oKVData[o+"/"+c]}}else{var f=n.Z.getContext("2d").getImageData(0,0,n.I,n.F).data[4*(Math.round(t.x-h.iX)+Math.round(t.y-h.iY)*n.I)+3],f=Math.min(255,Math.round(f*(1/n.C5))),r=n.B0+(n.BF-n.B0)*f/255;f<=0&&(r=null)}else(l=n.oKDTree.getNearestNeighbour({x:t.x,y:t.y},20))&&(r=l.v,o=l.key,c=l.val,u=l.info);if(ZC.AO.C0("heatmap.mousemove",a,{id:a.K,graphid:h.K,ev:t.ev,x:t.x,y:t.y,value:r}),n.A7)if(null!==ZC._n_(r)){if(t.ev.target&&"AREA"!==t.ev.target.tagName.toUpperCase()){var p,f=o,C=o,m=c,Z=c;if(n.AAX&&((p=h.BM(n.AAX.keyscale.name))&&(p=p.MU())[ZC._[68]]&&(p.utc=h.UK,p.timezone=h.NE,C=ZC.AO.G5(C,p,h.BO[0],!0)),p=h.BM(n.AAX.valscale.name))&&p.CL&&(Z=p.CL.replace(/%v|%scale-value/g,Z)),p={},ZC._cp_(n.A7,p),-1!==h.AF.indexOf("scatter")&&(p.x=l.x,p.y=l.y-("canvas"===a.AB?0:20),p.anchor="c",p[ZC._[7]]="xy"),n.A7["js-rule"])try{var A=ZC.execFn(n.A7["js-rule"].replace("javascript:","").replace("()",""),window,{key:o,val:c,v:r},u);A&&ZC._cp_(A,p)}catch(B){}h=zingchart.formatNumber(r,n.A7);p.text=p.text||h+"",-1!==p.text.indexOf("%")&&(p.text=p.text.replace(/%value/g,r+"").replace(/%scale-key-text/g,C).replace(/%scale-key-value/g,f).replace(/%scale-value-text/g,Z).replace(/%scale-value-value/g,m)),zingchart.exec(t.id,"showtooltip",{ev:t.ev,xy:!0,data:p})}}else t.ev.target&&"AREA"!==t.ev.target.tagName.toUpperCase()&&zingchart.exec(t.id,"hidetooltip",{})}}}}),r=!1,zingchart.bind(null,"resize",function(t){var a=zingchart.getLoader(t.id),e=zingchart.getModules(a);if(-1!==ZC.AV(e,"heatmap")){for(var i=[],s=0,h=0,n=a.AG.length;h<n;h++)a.AG[h].o.heatmap&&(i=[].concat(v[a.K+"-"+h].aDataInit),s=h);r=!0,window.setTimeout(function(){l(t),zingchart.exec(a.K,"heatmap.setdata",{data:i,graphid:s}),r=!1},33)}}),l=function(t){var a=zingchart.getLoader(t.id),t=zingchart.getModules(a);if(-1!==ZC.AV(t,"heatmap"))for(var e=0,i=a.AG.length;e<i;e++){var s=a.AG[e];if(s.o.heatmap){var h,n,r,l=s.o.heatmap||{},o=(s.o.options&&(l=s.o.options.heatmap||l),ZC._todash_(l),document.createElement("canvas")),c=(o.id=s.K+"-heatmap-c",o.className="canvas"===a.AB?"":"zc-no-print",o.width=s.I,o.height=s.F,ZC._c_(l[ZC._[7]],l.graph?"bottom":"top")),u=("canvas"===a.AB?("top"===c?ZC.AL(a.K+"-tools"):h=ZC.AL(s.K+"-plots-bl-0")||ZC.AL(s.K+"-plots-bl")).appendChild(o):((n=ZC.Q.F8("foreignObject",ZC._[36])).id=s.K+"-heatmap",ZC.Q.G6(n,{x:s.iX,y:s.iY,width:s.I,height:s.F}),n.style.opacity="0",n.appendChild(o),(r=ZC.Q.F8("image",ZC._[36])).id=s.K+"-heatmap-img",ZC.Q.G6(r,{x:s.iX,y:s.iY,width:s.I,height:s.F,href:""}),("top"===c?(ZC.AL(a.K+"-tools").appendChild(n),ZC.AL(a.K+"-tools")):((h=ZC.AL(s.K+"-plots-bl-0")||ZC.AL(s.K+"-plots-bl")).appendChild(n),h)).appendChild(r)),v[a.K+"-"+s.L]=new ZC.ZCHeatMap),c=(u.I=s.I,u.F=s.F,u.Z=o,u.AB=a.AB,"canvas"===a.AB&&(u.Z.style.position="absolute",u.Z.style.left=s.iX+"px",u.Z.style.top=s.iY+"px"),u.sBrushType=ZC._c_(l["brush-type"],"circle"),[[15,15],45]),d=("square"===u.sBrushType?c=[[15,15],5]:"rectangle"===u.sBrushType&&(c=[[10,15],5]),u.aSize=ZC._c_(l[ZC._[21]],c[0]),"object"!=typeof u.aSize&&(u.aSize=[ZC._f_(u.aSize),ZC._f_(u.aSize)]),u.iBlur=ZC._i_(ZC._c_(l.blur,c[1])),u.KU=ZC._b_(ZC._c_(l["async"],!1)),u.bSortData=ZC._b_(ZC._c_(l["sort-data"],!1)),u.C5=ZC._f_(ZC._c_(l.alpha,.5)),l.tooltip&&(u.A7=l.tooltip),ZC._n_(l["min-value"])&&(u.B0=ZC._f_(l["min-value"])),ZC._n_(l["max-value"])&&(u.BF=ZC._f_(l["max-value"])),u.Z.style.opacity=""+u.C5,l.graph&&(u.bComposite=!1,u.AAX={loaderid:a.K,graphid:s.K,keyscale:{name:ZC._[50],decimals:0},valscale:{name:ZC._[51],decimals:0}},l.graph["key-scale"]&&(u.AAX.keyscale.name=l.graph["key-scale"]),l.graph["val-scale"])&&(u.AAX.valscale.name=l.graph["val-scale"]),ZC._n_(l.composite)&&(u.bComposite=ZC._b_(l.composite)),["#0000ff","#00ffff","#bfff00","#ffff00","#ff0000"]),g=[.4,.6,.7,.8,1];l["gradient-colors"]&&(d=l["gradient-colors"].split(/\s|;/)),l["gradient-stops"]&&(g=l["gradient-stops"].split(/\s|;/)),u.aGradient=[];for(var f=0;f<Math.min(d.length,g.length);f++)u.aGradient.push([g[f],d[f]]);u.paint()}}},zingchart.bind(null,"load",l),zingchart.extendAPI("heatmap.setdata",function(t,a){"string"==typeof(a=a||{})&&(a=JSON.parse(a)),ZC._todash_(a,!0,["data"]);var e,t=zingchart.getLoader(t);t&&(e=t.CB(a[ZC._[3]]))&&(t=t.K+"-"+e.L,v)&&v[t]&&(null!==ZC._n_(a["min-value"])&&(v[t].B0=ZC._f_(a["min-value"])),null!==ZC._n_(a["max-value"])&&(v[t].BF=ZC._f_(a["max-value"])),null!==ZC._n_(a[ZC._[21]])&&(v[t].aSize=[ZC._f_(a[ZC._[21]]),ZC._f_(a[ZC._[21]])]),null!==ZC._n_(a.blur)&&(v[t].iBlur=ZC._f_(a.blur)),v[t].setData(a.data||[],e.AF),v[t].paint())}),ZC.ZCKDTreeNode=function(t){this.aPoint=t,this.oLeftChild=null,this.oRightChild=null,this.oBounds=null},ZC.ZCKDTree=function(t){for(var a={minX:ZC.MAX,maxX:-ZC.MAX,minY:ZC.MAX,maxY:-ZC.MAX},e=0,i=t.length;e<i;e++)a.minX=Math.min(a.minX,t[e].x),a.maxX=Math.max(a.maxX,t[e].x),a.minY=Math.min(a.minY,t[e].y),a.maxY=Math.max(a.maxY,t[e].y);this.M6=ZC.ZCKDTree.createKDTree(t,0,a)},ZC.ZCKDTree.createKDTree=function(t,a,e){var i,s,h,n;return 0===t.length?null:(i=a%2,t.sort(function(t,a){return 0==i?t.x-a.x:t.y-a.y}),s=Math.floor(t.length/2),n={minX:((h=new ZC.ZCKDTreeNode(t[s])).oBounds=e).minX,maxX:0==i?h.aPoint.x:e.maxX,minY:e.minY,maxY:1==i?h.aPoint.y:e.maxY},e={minX:0==i?h.aPoint.x:e.minX,maxX:e.maxX,minY:1==i?h.aPoint.y:e.minY,maxY:e.maxY},h.oLeftChild=ZC.ZCKDTree.createKDTree(t.slice(0,s),a+1,n),h.oRightChild=ZC.ZCKDTree.createKDTree(t.slice(s+1),a+1,e),h)},ZC.ZCKDTree.getDistance=function(t,a,e,i){return Math.sqrt((t-e)*(t-e)+(a-i)*(a-i))},ZC.ZCKDTree.prototype.getNearestNeighbour=function(t,a,e){var i=[];return this._getNearestNeighbours_(this.M6,t,0,i,1,e),0!==i.length&&i[0].H5<=a?i[0].AX.aPoint:null},ZC.ZCKDTree.prototype.getNearestNeighbours=function(t,a,e,i){for(var s=[],h=(this._getNearestNeighbours_(this.M6,t,0,s,a,i),[]),n=0,r=s.length;n<r;n++)s[n].H5<=e&&h.push(s[n].AX.aPoint);return h},ZC.ZCKDTree.prototype._getNearestNeighbours_=function(t,a,e,i,s,h){h&&h.push(t.aPoint);var n=e%2,r=ZC.ZCKDTree.getDistance(a.x,a.y,t.aPoint.x,t.aPoint.y);ZC.ZCKDTree.insertResult(i,{AX:t,H5:r},s);var l,o,r=(0==n?a.x:a.y)<(0==n?t.aPoint.x:t.aPoint.y),c=r?t.oLeftChild:t.oRightChild,r=r?t.oRightChild:t.oLeftChild;c&&this._getNearestNeighbours_(c,a,e+1,i,s,h),r&&(0==n?(l=t.aPoint.x,o=a.y,a.y<r.oBounds.minY?o=r.oBounds.minY:a.y>r.oBounds.maxY&&(o=r.oBounds.maxY)):(l=a.x,o=t.aPoint.y,a.x<r.oBounds.minX?l=r.oBounds.minX:a.x>r.oBounds.maxX&&(l=r.oBounds.maxX)),ZC.ZCKDTree.getDistance(a.x,a.y,l,o)<=i[i.length-1].H5)&&this._getNearestNeighbours_(r,a,e+1,i,s,h)},ZC.ZCKDTree.insertResult=function(t,a,e){for(var i=t.length-1;0<=i;--i){var s=t[i];if(a.H5>s.H5)break}t.splice(i+1,0,a),t.length>e&&t.pop()})}();