/*
All of the code within the ZingChart software is developed and copyrighted by ZingChart, Inc., and may not be copied,
replicated, or used in any other software or application without prior permission from ZingChart. All usage must coincide with the
ZingChart End User License Agreement which can be requested by email at support@zingchart.com.

Build 2.9.15
*/
ZC.A89={},ZC.WJ.push("export"),ZC.AO.A3W=function(e,t,n,a){"jpg"===(a=a||"png")&&(a="jpeg");for(var o=document.createElement("canvas"),i=(o.width=t,o.height=n,o.style.width=t+"px",o.style.height=n+"px",o.getContext("2d")),l=0,r=(e=e instanceof Array?e:[e]).length;l<r;l++)if(-1===e[l].className.indexOf("zc-no-print")){var s=!1;try{e[l].toDataURL("image/"+a)}catch(c){s=!0}s||((s=e[l].getAttribute("data-clip"))?(s=s.split(","),i.drawImage(e[l],ZC.BR(0,s[0]),ZC.BR(0,s[1]),ZC.CY(s[2],e[l].width),ZC.CY(s[3],e[l].height),ZC.BR(0,s[0]),ZC.BR(0,s[1]),ZC.CY(s[2],e[l].width),ZC.CY(s[3],e[l].height))):i.drawImage(e[l],0,0,e[l].width,e[l].height,0,0,t,n))}return o.toDataURL("image/"+a)},ZC.AO.ABM=function(e,t,n,a,o){null===ZC._n_(o)&&(o=!1);e=ZC.AO.A3W(e,t,n,a);if(o)return(t=document.createElement("img")).src=e,t;e=e.replace("image/"+a,"image/octet-stream"),document.location.href=e},ZC.Q9.prototype.AA4=function(){var n=this,a=[];if(!n.A7Q){n.A7Q=!0;var o=document.body.childNodes,i=ZC.A3(document.body).css(ZC._[0]),l=ZC.A3(document.body).css("background-image");ZC.A3(document.body).css(ZC._[0],"#fff").css("background-image","none");for(var e=0,t=o.length;e<t;e++)1===o[e].nodeType&&(a[e]=o[e].style.display,o[e].style.display="none");document.body.appendChild(ZC.AL(n.K+"-wrapper")),window.setTimeout(function(){window.print(),window.setTimeout(function(){ZC.A3(document.body).css(ZC._[0],i).css("background-image",l),ZC.AL(n.K+"-wrapper")&&ZC.AL(n.K).appendChild(ZC.AL(n.K+"-wrapper"));for(var e=0,t=o.length;e<t;e++)1===o[e].nodeType&&(o[e].style.display=a[e]);n.A7Q=!1},1e3)},50)}},ZC.Q9.prototype.OM=function(r,s,c,d){var p=this;if(s=s||{},typeof c===ZC._[31]&&(c=!1),!ZC.AL(p.K+"-viewimage")){r=r||"png";var u,e,h,n,g=s.download,C=s.fn||"",t=(ZC.Q.IW(ZC.AL(p.K+"-guide-c"),p.AB,0,0,p.I,p.F),ZC.A3(".zc-guide-label").remove(),("canvas"===p.AB||zingchart.AJAXEXPORT||zingchart.DEV.LOCALSVGEXPORT)&&"pdf"!==r&&"svg"!==r);if(ZC.mobile||!t||c||g||(u=ZC.Q.I2({cls:"zc-abs zc-viewimage zc-style",id:p.K+"-viewimage",zidx:5,p:ZC.AL(p.K+"-top"),wh:p.I+"/"+p.F}),e=ZC.Q.I2({id:p.K+"-viewimage-close",p:u,zidx:10,tl:"5/"+(p.I-15),html:ZC.HG["viewimage-close"]}),ZC.A3(e).css("cursor","pointer").css("left",p.I-15-ZC.A3(e).width()+"px"),ZC.A3(e).bind("click",function(){ZC.A3(u).remove()})),ZC.mobile&&(g=!0),!zingchart.DEV.LOCALSVGEXPORT||g||"svg"!==p.AB||"png"!==r&&"jpeg"!==r){if("canvas"===p.AB&&"pdf"!==r&&"svg"!==r){var a,o,i=document.createElement("canvas");for(i.width=p.I,i.height=p.F,a=0,o=p.AG.length;a<o;a++)p.AG[a].BE&&p.AG[a].BE.EO(i);var l=[],m=(ZC.A3("#"+p.K+" canvas").each(function(){-1===ZC.AV([p.K+"-guide-c",p.K+"-trigger-c"],this.id)&&l.push(this)}),l.push(i),l.push(p.createPreviewMasks()),ZC.AO.ABM(l,p.I,p.F,r,!0));m.id=p.K+"-print-"+r,u.appendChild(m)}else c||p.A8I(ZC.HG["export-wait"]),"vml"===p.AB||"canvas"===p.AB&&("pdf"===r||"svg"===r)?(m=document.createElement("div"),n="zc-export-svg-"+p.K,m.id=n,m.style.display="none",document.body.appendChild(m),zingchart.render({id:n,output:"!svg",imggen:!0,width:p.I,height:p.F,data:p.E.json,defaults:p.KR,theme:p.L2,hideprogresslogo:!0,events:{load:function(){window.setTimeout(function(){var e,t=zingchart.getLoader(n);t.E["dynamic-objects"]?e=window.setInterval(function(){"ready"===t.E["dynamic-objects"]&&(window.clearInterval(e),t.togglePreviewMasks(!0),h=ZC.AL(n+"-top").innerHTML,t.togglePreviewMasks(!1),zingchart.exec(n,"destroy",{skipfs:!0}),f())},100):(t.togglePreviewMasks(!0),h=ZC.AL(n+"-top").innerHTML,t.togglePreviewMasks(!1),zingchart.exec(n,"destroy",{skipfs:!0}),f())},100)}}})):"svg"===p.AB&&(p.togglePreviewMasks(!0),h=ZC.AL(p.K+"-top").innerHTML,f(),p.togglePreviewMasks(!1));t&&!c&&(ZC.A3(e).css("cursor","pointer").css("left",p.I-15-ZC.A3(e).width()+"px"),ZC.A3(e).bind("click",function(){ZC.A3(u).remove()}))}else zingchart.exec(p.K,"getimagedata",{callback:function(e){var t;-1!==e?((t=document.createElement("img")).id=p.K+"-print-"+r,t.src=e,u.appendChild(t)):(ZC.Q.EW(p.K+"-viewimage"),zingchart.DEV.LOCALSVGEXPORT=0,p.OM(r,s,c,d))}})}function f(){var e,t={svg:h=(h=h.replace(/<foreignObject(.+?)<\/foreignObject>/g,"")).replace(' xmlns="http://www.w3.org/2000/svg"',""),w:p.I,h:p.F,t:r,fn:C};if(ZC._cp_(s,t),zingchart.AJAXEXPORT&&"pdf"!==r&&"svg"!==r&&!g){var n="base64=1&";for(e in t)n+=e+"="+encodeURIComponent(t[e])+"&";ZC.A3.ajax({type:"post",url:zingchart.EXPORTURL,data:n,success:function(e,t,n){p.A49(),c?d&&d(e,t,n):((t=document.createElement("img")).src=e,t.id=p.K+"-print-"+r,u.appendChild(t))}})}else{ZC.AL(p.K+"-export")&&ZC.Q.EW(p.K+"-export");var a,o=ZC.Q.I2({cls:"zc-abs zc-style",id:p.K+"-export",p:ZC.AL(p.K+"-top"),display:"none"}),i=(a=null!==ZC._n_(t.uid)&&null!==ZC._n_(t.page)?ZC.Q.ABA(ZC.AL(p.K+"-export")):document).createElement("FORM");for(e in i.action=zingchart.EXPORTURL,i.method="post",i.enctype="multipart/form-data",(null!==ZC._n_(t.uid)&&null!==ZC._n_(t.page)?a.body:o).appendChild(i),i.style.display="none",t){var l=a.createElement("INPUT");l.type="hidden",l.name=e,l.value=t[e],i.appendChild(l)}i.submit(),(i=null)!==ZC._n_(t.uid)&&null!==ZC._n_(t.page)&&window.setTimeout(function(){ZC.A3("#"+p.K+"-export").remove()},6e4),window.setTimeout(function(){p.A49()},1e3)}}},ZC.Q9.prototype.Z8=function(e){var t,n,a=this,o=(e=e||"png",[]),i=document.createElement("canvas");for(i.width=a.I,i.height=a.F,t=0,n=a.AG.length;t<n;t++)a.AG[t].BE&&a.AG[t].BE.EO(i);return ZC.A3("#"+a.K+" canvas").each(function(){-1===ZC.AV([a.K+"-guide-c",a.K+"-tooltip-c"],this.id)&&o.push(this)}),o.push(i),o.push(a.createPreviewMasks()),ZC.AO.A3W(o,a.I,a.F,e)},ZC.AO.downloadFile=function(e,t,n){var a;ZC.ie678||(n=n||"application/octet-stream",a=document.createElement("a"),navigator.msSaveBlob?navigator.msSaveBlob(new Blob([e],{type:n}),t):URL&&"download"in a?(a.href=URL.createObjectURL(new Blob([e],{type:n})),a.setAttribute("download",t),document.body.appendChild(a),a.click(),document.body.removeChild(a)):location.href="data:application/octet-stream,"+encodeURIComponent(e))},ZC.AO.XW=function(e,t){var n,a,o,i,l,r,s,c,d,p=[],u="",h=[];for("xls"===(t=t||"csv")&&p.push('<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">',"<head>","\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>[ZC]</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e",'<style>td{border:none;font-family:Calibri,sans-serif} .number{mso-number-format:"0.00";} .text{mso-number-format:"@";}</style>',"<meta name=ProgId content=Excel.Sheet>","<meta charset=UTF-8>","</head>","<body>"),n=0,a=e.AG.length;n<a;n++){var g=e.AG[n],C=g.AY.A4,m=(e.E.fastlinedata&&(C=e.E.fastlinedata),{}),f=[],A=g.BW("k")[0],Z=("html"!==t&&"xls"!==t&&"raw"!==t||(p.push("<table>"),g.IM&&""!==g.IM.AN&&(h.push([g.IM.AN]),p.push("<caption>"+g.IM.AN+"</caption>")),p.push("<thead>"),p.push("<tr>")),s=[],"Category"),v=!(d=[]),w="%Y-%mm-%dd %H:%i:%s";for(A&&(A.F7&&"date"===A.F7.o.type&&(Z="Date",v=!0,A.F7.o["export-format"])&&(w=A.F7.o["export-format"]),A.M)&&A.M.AN&&(Z=A.M.AN.replace(/\"|\'/g,"")),"csv"===t?s.push('"'+Z+'"'):"raw"===t?d.push(Z):"html"!==t&&"xls"!==t||s.push("<th>"+Z+"</th>"),b=0,y=C.length;b<y;b++)null!==ZC._n_(C[b].o["export"])&&!ZC._b_(C[b].o["export"])||(c=(c=null!==ZC._n_(C[b].AN)?C[b].AN+"":"Series "+b).replace(/\"|\'/g,""),"csv"===t?s.push('"'+c+'"'):"raw"===t?d.push(c):"html"!==t&&"xls"!==t||s.push("<th"+("xls"===t?' scope="col" class="text"':"")+">"+c+"</th>"),f.push(""));if("csv"===t?p.push(s.join(",")):"raw"===t?h.push(d):"html"!==t&&"xls"!==t||p.push(s.join("")),"html"!==t&&"xls"!==t||(p.push("</tr>"),p.push("</thead>"),p.push("<tbody>")),A){for(l=0,r=A.V.length;l<r;l++)m[l+""]={hasData:!1,nodes:[].concat(f)};for(var x=[],b=0,y=C.length;b<y;b++)if(null===ZC._n_(C[b].o["export"])||ZC._b_(C[b].o["export"]))for(o=0,i=C[b].S.length;o<i;o++){var _=C[b].S[o];_&&(m[l=null!==ZC._n_(_.BV)?""+_.BV:""+o]=m[l]||{hasData:!0,nodes:[].concat(f)},m[l].nodes[b]=_.AC,m[l].hasData=!0,null!==ZC._n_(_.BV))&&x.push(""+_.BV)}var O=[];for(l in m)m[l].hasData&&O.push([l,m[l].nodes]);O.sort(function(e,t){return e[0]-t[0]});for(var k=null,E=0,L=O.length;E<L;E++){if("html"!==t&&"xls"!==t||p.push("<tr>"),"pie"!==g.AF&&"pie3d"!==g.AF&&"nestedpie"!==g.AF||null!==ZC._n_(A.V[O[E][0]])&&(O[E][0]=A.V[O[E][0]]),null!==ZC._n_(A.BY[O[E][0]])&&(O[E][0]=A.BY[O[E][0]]),null!==ZC._n_(A.V[O[E][0]])&&-1===ZC.AV(x,O[E][0])&&(O[E][0]=A.V[O[E][0]]),(k=g.A.FH()).row=E,k.col=0,k[ZC._[9]]=O[E][0],O[E][0]=ZC.AO.C0("dataexport",g.A,k,O[E][0],null),ZC._n_(O[E][1]))for(var K=0;K<O[E][1].length;K++)(k=g.A.FH()).row=E,k.col=K+1,k[ZC._[9]]=O[E][1][K],O[E][1][K]=ZC.AO.C0("dataexport",g.A,k,O[E][1][K],null);v&&(O[E][0]=ZC.AO.YF(O[E][0],w,g.UK,g.NE),"csv"===t)&&(O[E][0]='"'+O[E][0]+'"'),"csv"===t?p.push([].concat(O[E][0]).concat(O[E][1]).join(",")):"raw"===t?h.push([].concat(O[E][0]).concat(O[E][1])):"html"!==t&&"xls"!==t||p.push("<td"+("xls"===t?' scope="row"':"")+">"+[].concat(O[E][0]).concat(O[E][1]).join("</td><td>")+"</td>"),"html"!==t&&"xls"!==t||p.push("</tr>")}}"html"!==t&&"xls"!==t||(p.push("</tbody>"),p.push("</table>")),1<a&&n<a-1&&("csv"===t?p.push("","",""):"html"!==t&&"xls"!==t||p.push("<p>&nbsp;</p>"))}return"xls"===t&&p.push("</body>","</html>"),"raw"===t?h:("csv"===t?u=p.join("\n"):"html"!==t&&"xls"!==t||(u=p.join("")),u)},zingchart.ABC=function(e,t,i){var n,a,o="",l="";function r(e){ZC.A3.ajax({type:"post",url:n,data:e,success:function(e,t,n){a&&a(e,t,n)}})}document.getElementById("zc-fullscreen")&&(e="zc-fullscreen"),"string"==typeof(i=i||{})&&(i=JSON.parse(i));var s,c=zingchart.getLoader(e);if(c)switch(t){case"getimagedata":var d,p,u,h,g="png";if(null!==ZC._n_(s=i.format)&&(g=s),"jpg"===(g=null!==ZC._n_(s=i.filetype)?s:g)&&(g="jpeg"),!zingchart.DEV.LOCALSVGEXPORT||"svg"!==c.AB||"png"!==g&&"jpeg"!==g||(c.togglePreviewMasks(!0),m=(d=ZC.AL(c.K+"-svg").parentNode.innerHTML).indexOf(">"),C=d.indexOf("</svg>"),d=(d='<svg xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" version="1.1" width="'+c.I+'" height="'+c.F+'">[CSS]'+d.substring(m+1,C+6)).replace(/<foreignObject(.+?)<\/foreignObject>/g,""),p=function(){var a,e=window.URL||window.webkitURL||window,t=!1,o=(navigator&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&(t=!0),a=e.createObjectURL&&window.Blob&&!t?e.createObjectURL(new window.Blob([d],{type:"image/svg+xml;charset-utf-16"})):"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(d),c.togglePreviewMasks(!1),new window.Image);o.crossOrigin="anonymous",o.src=a,o.onload=function(){var e=document.createElement("canvas"),t=e.getContext("2d");if(e.width=o.width,e.height=o.height,t.drawImage(o,0,0,e.width,e.height),i.callback&&"function"==typeof i.callback)try{i.callback(e.toDataURL("image/"+g))}catch(n){i.callback(a)}}},u=0,h=function(){var e=new XMLHttpRequest;e.open("get",c.A27[u]),e.responseType="text",e.onloadend=function(e){var a=e.target.response,o=a.match(/https?:\/\/[^ \)]+/g),i=0;o.forEach(function(n){var e=new XMLHttpRequest;e.open("get",n),e.responseType="blob",e.onloadend=function(e){var t=new FileReader;t.onloadend=function(e){a=a.replace(new RegExp(n),e.target.result),++i===o.length&&(d=d.replace("[CSS]","[CSS]<style><![CDATA["+a+"]]></style>"),(++u===c.A27.length?(d=d.replace("[CSS]",""),p):h)())},t.readAsDataURL(e.target.response)},e.send()})},e.send()},(c.A27.length?h:(d=d.replace("[CSS]",""),p))()),"canvas"!==c.AB&&!zingchart.AJAXEXPORT)return-1;if("canvas"===c.AB){if(!i.callback||"function"!=typeof i.callback)return c.Z8(g);try{i.callback(c.Z8(g))}catch(f){i.callback(-1)}}else c.OM(g,{},!0,i.callback);break;case"exportimage":case"saveasimage":if(!i.download&&"canvas"!==c.AB&&!zingchart.AJAXEXPORT)return-1;if(g="png",m={},null!==ZC._n_(s=i.options)&&(m=s),null!==ZC._n_(s=i.uid)&&(m.uid=s),null!==ZC._n_(s=i.page)&&(m.page=s),null!==ZC._n_(s=i.format)&&(g=s),null!==ZC._n_(s=i.filetype)&&(g=s),null!==ZC._n_(s=i.filename)&&(o=s),n=c.E.exportimageurl||"",null!==ZC._n_(s=i.url)&&(n=s),(a=null)!==ZC._n_(s=i.callback)&&(a=s),"jpg"===g&&(g="jpeg"),i.download&&("canvas"!==c.AB||"pdf"===g))return m.download=!0,""!==o&&(m.fn=o),void c.OM(g,m);if(""!==n){if("canvas"===c.AB)return r(c.Z8(g));c.OM(g,m,!0,r)}break;case"exportdata":if(n=c.E.exportdataurl||"",null!==ZC._n_(s=i.url)&&(n=s),l=ZC.AO.XW(c,"csv"),""===n)return l;(a=null)!==ZC._n_(s=i.callback)&&(a=s),ZC.A3.ajax({type:"post",url:n,data:l,success:function(e,t,n){a&&a(e,t,n)}});break;case"downloadCSV":l=ZC.AO.XW(c,"csv"),ZC.AO.downloadFile(l,(i.fn||c.K)+".csv","text/csv;encoding:utf-8");break;case"downloadXLS":var l=ZC.AO.XW(c,"xls"),C=i.sn||"ZingChart";l=l.replace("<x:Name>[ZC]</x:Name>","<x:Name>"+C+"</x:Name>"),ZC.AO.downloadFile(l,(i.fn||c.K)+".xls","application/vnd.ms-excel;encoding:utf-8");break;case"downloadRAW":var m=ZC.AO.XW(c,"raw");if(!i.callback||"function"!=typeof i.callback)return m;try{i.callback(m,i.fn||c.K)}catch(f){i.callback(-1)}break;case"viewDataTable":"viewdatatable"===i.menuid?(l=ZC.AO.XW(c,"html"),ZC.AL(c.K+"-data-table")?ZC.AL(c.K+"-data-table").innerHTML=l:(s=ZC.Q.I2({id:c.K+"-data-table",cls:"zc-data-table "+c.K+"-data-table"}),ZC.Q.P9(s,{width:c.I+"px","max-height":"400px",overflow:"auto"}),s.innerHTML=l,ZC.AL(c.K).parentNode.insertBefore(s,ZC.AL(c.K).nextSibling))):"hidedatatable"===i.menuid&&ZC.Q.EW(c.K+"-data-table")}return null};