/*
All of the code within the ZingChart software is developed and copyrighted by ZingChart, Inc., and may not be copied,
replicated, or used in any other software or application without prior permission from ZingChart. All usage must coincide with the
ZingChart End User License Agreement which can be requested by email at support@zingchart.com.

Build 2.9.2_ES6
*/
zingchart.setModule("bubble-pack"),function(){var a=function(a,e,t,r){return[a+t*Math.cos(2*r*Math.PI/360),e+t*Math.sin(2*r*Math.PI/360)]},e=function(a){return 360*a/(2*Math.PI)},t=function(a,e,t){for(var r,n=t.padding,i=0;i<e.length;i++)if(r=Math.sqrt((a.x-e[i].x)*(a.x-e[i].x)+(a.y-e[i].y)*(a.y-e[i].y)),Math.round(r-a.r-e[i].r)<0)return!1;return r=Math.sqrt((a.x-t.x)*(a.x-t.x)+(a.y-t.y)*(a.y-t.y)),!(t.r-r-a.r<n)},r=function(r,n,i){for(var l,o,p,u=r.r,g=i.padding,h=!1,_=[],c=0;c<n.length;c++)for(var d=0;d<n.length;d++){var f=Math.sqrt((n[c].x-n[d].x)*(n[c].x-n[d].x)+(n[c].y-n[d].y)*(n[c].y-n[d].y));if(c!==d&&Math.floor(Math.abs(f-n[c].r-n[d].r))<=g){var C,Z,s,b,x,v=(u+n[d].r)*(u+n[d].r)-(u+n[c].r)*(u+n[c].r),y=n[c].r+n[d].r,m=(v+y*y)/(2*y),z=Math.sqrt((u+n[d].r)*(u+n[d].r)-m*m),M=(l=n[c],o=n[d],void 0,[p=(l.y-o.y)/(l.x-o.x),l.y-p*l.x,Math.atan((o.y-l.y)/(o.x-l.x))]);b=(s=a(n[d].x,n[d].y,m,e(M[2])))[0],x=s[1],(b<Math.min(n[c].x,n[d].x)||b>Math.max(n[c].x,n[d].x)||x<Math.min(n[c].y,n[d].y)||x>Math.max(n[c].y,n[d].y))&&(b=(s=a(n[d].x,n[d].y,m,e(M[2])+180))[0],x=s[1]),C={x:(Z=a(b,x,z,e(M[2])+90))[0],y:Z[1],r:u,padding:g,idx:r.idx,info:r},t(C,n,i)&&(_.push(C),h=!0),C={x:(Z=a(b,x,z,e(M[2])+270))[0],y:Z[1],r:u,padding:g,idx:r.idx,info:r},t(C,n,i)&&(_.push(C),h=!0)}}return _.sort(function(a,e){return Math.sqrt((a.x-i.x)*(a.x-i.x)+(a.y-i.y)*(a.y-i.y))-Math.sqrt((e.x-i.x)*(e.x-i.x)+(e.y-i.y)*(e.y-i.y))}),_.length&&n.push(_[0]),h};zingchart.plugins.bubblepack=zingchart.plugins.bubblepack||{},zingchart.plugins.bubblepack.info=zingchart.plugins.bubblepack.info||{},zingchart.plugins.bubblepack.cache=zingchart.plugins.bubblepack.cache||{};var n=function(a,e,t){var n;if(""!==e.uid&&zingchart.plugins.bubblepack.cache[e.uid])return zingchart.plugins.bubblepack.cache[e.uid];var i=e.r,l=e.x,o=e.y,p=e.padding,u=e.maxItems||999,g=e.minSize||1.5,h=zingchart.plugins.bubblepack.info.groups[t]||{};a.sort(function(a,e){return a.group&&e.group?a.group===e.group?parseFloat(e[ZC._[9]])-parseFloat(a[ZC._[9]]):null!==ZC._n_(h[a.group])&&null!==ZC._n_(h[e.group])?h[a.group]-h[e.group]:a.group<e.group?1:a.group>e.group?-1:0:parseFloat(e[ZC._[9]])-parseFloat(a[ZC._[9]])});var _=Math.min(u,a.length),c=0;for(n=0;n<_;n++)a[n].r=a[n]._r_=Math.sqrt(parseFloat(a[n][ZC._[9]])/Math.PI)+p/2,a[n].idx=n,c+=a[n].r*a[n].r*Math.PI;var d=1;if(_>1)if(_<25)d=Math.max(1e-4,(i-3*p)/(a[0].r+a[1].r));else{var f=.8;f=_>=50&&_<75?.85:_>=75&&_<100?.9:_>=100&&_<150?.95:1,d=Math.max(1e-4,Math.sqrt(f*i*i*Math.PI/c))}else 0===p&&(e.padding=p=1),d=Math.max(1e-4,(i-2*p)/a[0].r);var C=d/150,Z=1;_>25&&_<=50?(C=d/125,Z=1):_>50&&_<=100?(C=d/100,Z=1.125):_>100&&_<=200?(C=d/75,Z=1.25):_>200&&(C=d/50,Z=1.5);for(var s=[],b=!0;b;){for(b=!1,n=0;n<_;n++)a[n].r=a[n]._r_*d;if(s=[],_>1)if(2*a[0].r+2*a[1].r+3*p>2*i)(d-=C)>0&&(b=!0);else{var x=a[0].r+a[1].r+p/2;for(s.push({x:l-x+a[0].r,y:o,r:a[0].r,idx:0,info:a[0]}),s.push({x:l+x-a[1].r,y:o,r:a[1].r,idx:1,info:a[1]}),n=2;n<_;n++){if(a[n].r>=g)if(!r(a[n],s,e)){var v=n/_,y=1;if(_>100&&(v>=0&&v<.1?y=1.2:v>=.1&&v<.2?y=1.15:v>=.2&&v<.3?y=1.1:v>=.3&&v<.4&&(y=1.05),C+=y*Z*C*(1-v)),(d-=C)>0){b=!0;break}}}}else s.push({x:l,y:o,r:a[0].r-p,idx:0,info:a[0]})}return""!==e.uid&&(zingchart.plugins.bubblepack.cache[e.uid]=s),s},i=function(a,e){var t=ZC.IQ(a.x||"0",!1);t<=1&&(t=e.x+e.width*t);var r=ZC.IQ(a.y||"0",!1);r<=1&&(r=e.y+e.height*r);var n=ZC.IQ(a[ZC._[19]]||"0",!1);n<=1&&(n=e.width*n);var i=ZC.IQ(a[ZC._[20]]||"0",!1);return i<=1&&(i=e.height*i),{x:t+n/2,y:r+i/2,r:Math.min(n,i)/2}};zingchart.bind(null,"dataparse",function(a,e){for(var t,r,n,i,l=0,o=e[ZC._[16]].length;l<o;l++)if(e[ZC._[16]][l].type&&"bubble-pack"===e[ZC._[16]][l].type){var p=e[ZC._[16]][l].type;e[ZC._[16]][l]["plugin-type"]=p;var u=e[ZC._[16]][l];zingchart.normalize(u),u.type="null";var g={};u.options&&(g=u.options[p]||u.options),ZC._todash_(g),u[ZC._[11]]=u[ZC._[11]]||[];var h=g["text-attr"]||"text",_=g["value-attr"]||ZC._[9];if(!(u[ZC._[11]]instanceof Array)){var c=[],d={},f=function(a,e){var t=(a.text||a.name||a[h]).toLowerCase().replace(/[^a-z0-9_]+/gi,"");d[t]?t+=d[t]++:d[t]=1;var r={id:t,text:a.text||a.name||a[h]||t,value:a[ZC._[9]]||a[ZC._[21]]||a[_],parent:e||""};if(c.push(r),a.children)for(var n=0;n<a.children.length;n++)f(a.children[n],t)};f(u[ZC._[11]]),u[ZC._[11]]=c}for(t=0;t<u[ZC._[11]].length;t++)u[ZC._[11]][t].text=u[ZC._[11]][t].text||u[ZC._[11]][t].name||u[ZC._[11]][t][h],u[ZC._[11]][t][ZC._[9]]=u[ZC._[11]][t][ZC._[9]]||u[ZC._[11]][t][ZC._[21]]||u[ZC._[11]][t][_];var C=g["group-filter"]||[];for(zingchart.plugins.bubblepack.info.groups=zingchart.plugins.bubblepack.info.groups||{},zingchart.plugins.bubblepack.info.size=zingchart.plugins.bubblepack.info.size||{},zingchart.plugins.bubblepack.info.size[a.id]=u[ZC._[11]].length,zingchart.plugins.bubblepack.info.groups[a.id]={},t=0;t<C.length;t++)zingchart.plugins.bubblepack.info.groups[a.id][C[t]]=t;var Z=C.length;for(t=0;t<u[ZC._[11]].length;t++)if(u[ZC._[11]][t].group&&null===ZC._n_(zingchart.plugins.bubblepack.info.groups[a.id][u[ZC._[11]][t].group])&&(zingchart.plugins.bubblepack.info.groups[a.id][u[ZC._[11]][t].group]=Z++),null!==ZC._n_(u[ZC._[11]][t].parent))for(r=0;r<u[ZC._[11]].length;r++)u[ZC._[11]][r].id===u[ZC._[11]][t].parent&&(u[ZC._[11]][t].pidx=r,u[ZC._[11]][r].children=u[ZC._[11]][r].children||[],u[ZC._[11]][r].children.push(t));for(var s=!0,b=[];s;)for(s=!1,t=0;t<u[ZC._[11]].length;t++)if(null!==ZC._n_(u[ZC._[11]][t].parent)&&(n=u[ZC._[11]][t].parent,-1===ZC.AV(b,n))){var x=0,v=!0;for(i=-1,r=0;r<u[ZC._[11]].length;r++)u[ZC._[11]][r].id===n&&(i=r,u[ZC._[11]][t].pidx=r),null!==ZC._n_(u[ZC._[11]][r].parent)&&u[ZC._[11]][r].parent===n&&(null!==ZC._n_(u[ZC._[11]][r][ZC._[9]])?x+=ZC._f_(u[ZC._[11]][r][ZC._[9]]):v=!1);if(v&&-1!==i){u[ZC._[11]][i][ZC._[9]]=x,b.push(n),s=!0;continue}}for(var y=!0;y;)for(y=!1,t=0;t<u[ZC._[11]].length;t++)null===ZC._n_(u[ZC._[11]][t].level)&&(null===ZC._n_(u[ZC._[11]][t].parent)||""===u[ZC._[11]][t].parent?u[ZC._[11]][t].level=0:(i=u[ZC._[11]][t].pidx,null!==ZC._n_(i)&&(null===ZC._n_(u[ZC._[11]][i].level)?y=!0:u[ZC._[11]][t].level=ZC._i_(u[ZC._[11]][i].level)+1)));u.plotarea=u.plotarea||{},ZC._inj_(u.plotarea,{margin:"40 10 10 10","mask-tolerance":[0,0]})}return e});var l=function(a){var e,t,r=zingchart.getLoader(a.loader.id),l=zingchart.getGraph(r,a.graphid),o=l.o;if("bubble-pack"===o["plugin-type"]){var p=zingchart.getGraphInfo(r,o,l.L).plotarea;o.shapes=o.shapes||[];var u={};if(o.options&&(u=o.options["bubble-pack"]||o.options),ZC._todash_(u),a.shape&&null!==ZC._n_(u.active)&&!ZC._b_(u.active))return;var g=u.palette||["#FFEC94","#FFAEAE","#B0E57C","#B4D8E7","#FCCB8E"],h=o[ZC._[11]]||[],_=ZC._f_(ZC._c_(u.padding,1)),c=ZC._i_(ZC._c_(u["min-level"],0)),d=ZC._i_(ZC._c_(u["max-items"],999)),f=u.filter||[],C=u["group-filter"]||[],Z=ZC._f_(ZC._c_(u["min-size"],1.5)),s=u.containers||{},b=u.format||{},x=[].concat(f),v=c,y=a["data-top"]||"";if(""===y){var m="",z=0;for(e=0;e<h.length;e++)h[e].parent&&""!==h[e].parent||(m=h[e].id,z++);1===z&&(y=m)}null!==ZC._n_(a["data-level"])&&(c=a["data-level"],y===a["data-id"]&&c--),null!==ZC._n_(a["data-id"])&&(y===a["data-id"]?(f=[a["data-parent"]],y=a["data-parent"]):(f=[a["data-id"]],y=a["data-id"])),c<v&&(c=v,f=[].concat(x));var M,k,I,w=[],F=ZC._i_(p.x+p.width/2),E=ZC._i_(p.y+p.height/2),q=ZC._i_(Math.min(p.width/2,p.height/2)),A=0;for(e=0;e<h.length;e++)A=Math.max(A,h[e].level);ZC._n_(u["max-level"])&&(A=ZC._i_(u["max-level"]));for(var P=c;P<=A;P++){for(k={},e=0;e<h.length;e++)if(h[e].level===P){if(I=h[e].parent||"0",P===c){var Q=h[e].id;I=s[Q]?Q:"0"}k[I]=k[I]||[],(!f.length||h[e].level!==c||f.length&&-1!==ZC.AV(f,h[e].id))&&(""===h[e].group||!C.length||C.length&&-1!==ZC.AV(C,h[e].group))&&k[I].push(h[e])}for(I in k){var S=y+"/"+I+"/"+c+"/"+A;if(k[I].length){if(P===c)s[I]?((M=i(s[I],p)).padding=_,M.minSize=Z,M.uid=""):M={uid:S,x:F,y:E,r:q,level:P,maxItems:d,minSize:Z,padding:_};else{M=null;for(var j=0;j<w.length;j++)w[j].info.id===I&&(M={uid:S,x:w[j].x,y:w[j].y,r:w[j].r,level:P,maxItems:d,minSize:Z,padding:_})}M&&(w=w.concat(n(k[I],M,a.id)))}}}var B=[];for(e=0;e<w.length;e++){var L=w[e].r-_/2;if(L>=Z){var R=w[e].info,V=zingchart.formatNumber(R.value,b),G=R.text||"",O=G,D=V,N=Math.min(29,Math.floor(2*L*1.45/Math.max(3,G.length)));N<9&&(G=G.substring(0,3)+"...",(N=Math.min(29,Math.floor(2*L*1.45/Math.max(3,G.length))))<9&&(G="",V=""));var T=Math.min(19,Math.floor(2*L*.75/Math.max(3,V.length)));T<9&&(V=""),L<10&&(G=V="");var Y=g[w[e].info.level%g.length];w[e].info.group&&(Y=null!==ZC._n_(t=zingchart.plugins.bubblepack.info.groups[a.id][w[e].info.group])?g[(w[e].info.level+t)%g.length]:"#"+ZC.Y7.md5(w[e].info.group).substring(0,6));var H={type:"circle",id:"bp_"+w[e].info.id,"data-id":w[e].info.id,"data-level":w[e].info.level,"data-parent":w[e].info.parent,"data-top":y,cls:"bp_item","border-width":1,"border-color":"#999","background-color":Y,alpha:1,"text-align":"center",cursor:"hand",size:L,x:w[e].x,y:w[e].y,"hover-state":{"border-width":1,"border-color":"#000","background-color":"none"},label:{text:""},tooltip:{text:"%fullname<br>%fullvalue"}};w[e].info.children&&0!==w[e].info.children.length&&w[e].info.level!==A||(H.label={text:'<span style="font-size:'+N+'px">%name</span><br><span style="font-size:'+T+'px">%value</span>'}),ZC._cp_(u.item,H),ZC._cp_(u["item-level-"+w[e].info.level],H),ZC._cp_(u["item-group-"+w[e].info.group],H),ZC._cp_(u["item-id-"+w[e].info.id],H);var J=null;for(var K in H.label.text=H.label.text.replace(/%fullname/g,O).replace(/%name/g,G).replace(/%fullvalue/g,D).replace(/%value/g,V),H.tooltip.text=H.tooltip.text.replace(/%fullname/g,O).replace(/%name/g,G).replace(/%fullvalue/g,D).replace(/%value/g,V),w[e].info)0===K.indexOf("data-")&&(J=new RegExp("%"+K,"g"),H.label.text=H.label.text.replace(J,w[e].info[K]),H.tooltip.text=H.tooltip.text.replace(J,w[e].info[K]));J=new RegExp("%data-([a-zA-Z0-9]+)","g"),H.label.text=H.label.text.replace(J,""),H.tooltip.text=H.tooltip.text.replace(J,""),J=new RegExp("<br><span(.+?)></span>","g"),H.label.text=H.label.text.replace(J,""),B.push(H)}}zingchart.exec(a.id,"removeobject",{type:"shape",cls:"bp_item"}),zingchart.exec(a.id,"addobject",{type:"shape",data:B})}};zingchart.bind(null,"gload",function(a){l(a)}),zingchart.bind(null,"shape_click",function(a){for(var e in ZC.cache.data)-1!==e.indexOf("area-score-"+a.id)&&delete ZC.cache.data[e];zingchart.plugins.bubblepack.info.size[a.id]>500&&zingchart.exec(a.id,"disable",{}),window.setTimeout(function(){l(a),zingchart.exec(a.id,"enable",{})},1)})}();