/*
All of the code within the ZingChart software is developed and copyrighted by ZingChart, Inc., and may not be copied,
replicated, or used in any other software or application without prior permission from ZingChart. All usage must coincide with the
ZingChart End User License Agreement which can be requested by email at support@zingchart.com.

Build 2.9.15
*/
zingchart.setModule("waterfall"),zingchart.bind(null,"dataparse",function(e,a){for(var r=0,l=a.graphset.length;r<l;r++)if(a.graphset[r].type&&("waterfall"===a.graphset[r].type.replace("3d","")||"hwaterfall"===a.graphset[r].type.replace("3d",""))){var t=a.graphset[r].type;a.graphset[r]["plugin-type"]=t;var i=a.graphset[r],p={};i.options&&(p=i.options[t]||i.options),ZC._todash_(p),i["scale-x"]=i["scale-x"]||{},i["scale-x"].values=i["scale-x"].values||[],i.series=i.series||[],i.series[0]=i.series[0]||{},i.series[0].values=i.series[0].values||[],i.plot=i.plot||{},i.plot.mode="normal",i.type="waterfall"===t.replace("3d","")?"vbar":"hbar",-1!==t.indexOf("3d")&&(i.type+="3d");for(var s=i.series,o=[0],n=[],d=0,u=s[0].values,h=0;h<u.length;h++)if("SUM"!==(""+u[h]).toUpperCase())d+=ZC._f_(u[h]),o.push(d),n.push("");else{h<u.length-1?n.push("INTERMEDIATE"):n.push("FINAL"),u[h]=d;var c=o.pop();o.push(0),o.push(c),d=c}o.pop(),s[0]["offset-values"]=o,s[0]["data-sum"]=n,i.plot=i.plot||{},i.plot.rules=i.plot.rules||[];var g={rule:"%node-numeric-value >= 0","background-color":"#7CA82B #7CA82B"};ZC._cp_(p.positive,g);var C={rule:"%node-numeric-value < 0","background-color":"#D31E1E #D31E1E"};ZC._cp_(p.negative,C);var v={rule:'"%data-sum" === "INTERMEDIATE"',"background-color":"#29A2CC #29A2CC"};ZC._cp_(p.intermediate,v);var A={rule:'"%data-sum" === "FINAL"',"background-color":"#29A2CC #29A2CC"};ZC._cp_(p.final,A),i.plot.rules.unshift(g,C,v,A)}return a}),zingchart.bind(null,"gcomplete",function(e){var a=zingchart.getLoader(e.loader.id),r=zingchart.getGraph(a,e.graphid),l=r.o;if(l["plugin-type"]=l["plugin-type"]||"","waterfall"===l["plugin-type"].replace("3d","")||"hwaterfall"===l["plugin-type"].replace("3d","")){var t={};l.options&&(t=l.options[l["plugin-type"]]||l.options),ZC._todash_(t),zingchart.exec(e.loader.id,"deleteobject",{type:"shape",id:"waterfall-line"});for(var i,p=r.AY.A4[0].S,s=r.BW("k")[0],o=[],n=function(e,a,l){if(l){var t=new ZC.CE(r,e[0]-ZC.AM.E1,e[1]-ZC.AM.E2,0),i=new ZC.CE(r,a[0]-ZC.AM.E1,a[1]-ZC.AM.E2,0);return[t.EC,i.EC]}return[e,a]},d=0;d<p.length-1;d++){var u,h,c=p[d],g=p[d+1];"vbar"===r.AF||"vbar3d"===r.AF?(c.CR>=0?(u=c.iYVal,h=c.iYVal+c.F):(u=c.iYVal+c.F,h=c.iYVal),i=c.CR>=0?s.AW?n([c.iX,u],[g.iX+g.I,u],"vbar3d"===r.AF):n([c.iX+c.I,u],[g.iX,u],"vbar3d"===r.AF):s.AW?n([c.iX,h],[g.iX+g.I,h],"vbar3d"===r.AF):n([c.iX+c.I,h],[g.iX,h],"vbar3d"===r.AF)):"hbar"!==r.AF&&"hbar3d"!==r.AF||(c.CR>=0?(u=c.iXVal,h=c.iXVal+c.I):(u=c.iXVal+c.I,h=c.iXVal),i=c.CR>=0?s.AW?n([u,c.iY+c.F],[u,g.iY],"hbar3d"===r.AF):n([u,c.iY],[u,g.iY+g.F],"hbar3d"===r.AF):s.AW?n([h,c.iY+c.F],[h,g.iY],"hbar3d"===r.AF):n([h,c.iY],[h,g.iY+g.F],"hbar3d"===r.AF)),o.push(i[0],i[1]),o.push(null)}var C={type:"line",id:"waterfall-line","line-width":2,"line-style":"dotted","line-color":"#000",flat:!0,points:o};ZC._cp_(t.line,C),zingchart.exec(e.loader.id,"addobject",{type:"shape",data:C})}});