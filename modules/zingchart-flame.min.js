/*
All of the code within the ZingChart software is developed and copyrighted by ZingChart, Inc., and may not be copied,
replicated, or used in any other software or application without prior permission from ZingChart. All usage must coincide with the
ZingChart End User License Agreement which can be requested by email at support@zingchart.com.

Build 2.9.15
*/
zingchart.setModule("flame"),function(){zingchart.plugins.flame=zingchart.plugins.flame||{};var j={},S={},q={},H={};zingchart.bind(null,"dataparse",function(t,e){for(var a,l=0,J=e[ZC._[16]].length;l<J;l++)if(e[ZC._[16]][l].type&&("flame"===e[ZC._[16]][l].type||"vflame"===e[ZC._[16]][l].type)){S[t.id]||(S[t.id]={}),q[t.id]||(q[t.id]=-1),H[t.id]=[],j[t.id]||(j[t.id]=JSON.stringify(e));for(var o,i,n,r=e[ZC._[16]][l].type,p=(e[ZC._[16]][l]["plugin-type"]=r,e[ZC._[16]][l]),_=(zingchart.normalize(p),p.type="flame"===r?"hbar":"vbar",{}),C=(p.options&&(_=p.options[r]||p.options),ZC._todash_(_),_.root||""),Z=(t.id,_.palette||["#6A921F","#007FA3","#A62B02","#B79007","#563D02","#0B32A0","#00BAF2","#E80C60","#E2D51A","#9B26AF","#FB301E","#00AE4D","#20398B"]),d=_["text-attr"]||"text",c=_["value-attr"]||ZC._[9],h=(p[ZC._[11]]=p[ZC._[11]]||[],p[ZC._[11]]instanceof Array||(o=[],i={},(n=function(t,e){var a=(t.text||t.name||t[d]).toLowerCase().replace(/[^a-z0-9_]+/gi,""),e=(i[a]?a+=i[a]++:i[a]=1,{id:a,text:t.text||t.name||t[d]||a,value:t[ZC._[9]]||t[ZC._[21]]||t[c],parent:e||""});if(o.push(e),t.children)for(var l=0;l<t.children.length;l++)n(t.children[l],a)})(p[ZC._[11]]),p[ZC._[11]]=o),{}),v=[].concat(p[ZC._[11]]).reverse(),K=0,D=v.length,f=0;v.length&&0<=D--;)for(y=v.length-1;0<=y;y--)a=(F=v[y]).id||"id"+K++,""===(I=F.parent||"")?(h[a]={id:a,level:0,parent:"",text:F.text||F.name||F[d]||a,value:F[ZC._[9]]||F[ZC._[21]]||F[c],children:[]},H[t.id].push(a),v.splice(y,1)):h[I]&&(h[I].children.push(a),h[a]={id:a,level:h[I].level+1,parent:I,text:F.text||F.name||F[d]||a,value:F[ZC._[9]]||F[ZC._[21]]||F[c],children:[]},v.splice(y,1),f=Math.max(f,h[a].level));var s=function(t,e){return e=e||[],h[t]&&""!==h[t].parent&&(e.push(h[t].parent),e=e.concat(s(h[t].parent))),e};if(""!==C){for(a in h)a!==C?(m=s(a),-1===ZC.AV(m,C)&&delete h[a]):(h[a]["up-parent"]=h[a].parent,h[a].parent="");var L=h[C].level;for(a in h)h[a].level-=L;f-=L}for(var N=0,g=0,u=0;u<=f;u++){if(0===u)for(a in h)0===h[a].level&&g++;for(a in h){var x="";S[t.id][a]?x=S[t.id][a]:(h[a].level===u&&(x=0===h[a].level||1===h[a].level&&1===g?Z[N++%Z.length]:h[h[a].parent].color),S[t.id][a]=x),h[a].color=x}}var m,b,O=function(t){if(h[t]){if(null===ZC._n_(h[t][ZC._[9]]))if(0===h[t].children.length)h[t][ZC._[9]]=0;else{for(var e=0,a=0;a<h[t].children.length;a++)e+=O(h[t].children[a]);h[t][ZC._[9]]=e}return parseFloat(h[t][ZC._[9]])}};for(a in h)h[a][ZC._[9]]=O(a);if(-1===q[t.id]){for(a in h)0===h[a].level||1===h[a].level&&1===g||S[t.id][a]&&(m=s(a),b=1===g?m[m.length-2]:m[m.length-1],b=1-h[a][ZC._[9]]/h[b][ZC._[9]],S[t.id][a]=h[a].color=ZC.AO.PP(h[a].color,40*b));q[t.id]=1}var z=[],P=0;for(u=0;u<=f;u++){if(z[u]){for(var A=[],y=0;y<z[u].length;y++){for(var F,k,Y=(F=h[z[u][y]]).children,w=0,B=0;B<Y.length;B++)A.push(Y[B]),w+=h[Y[B]][ZC._[9]];w<F[ZC._[9]]&&(k="sbfakeid"+P++,h[k]={id:k,parent:F.id,value:F[ZC._[9]]-w,level:F.level,children:[],fake:!0,color:F.color},A.push(k))}z[u]=[].concat(A)}else for(a in z[u]=[],h)h[a].level===u&&z[u].push(a);u<f&&(z[u+1]=[].concat(z[u]))}var M=0;for(y=0;y<z[0].length;y++)M+=h[z[0][y]].value;for(p.flat=!0,p.plotarea=p.plotarea||{},p.plotarea["mask-tolerance"]=p.plotarea["mask-tolerance"]||[0,0],p[ZC._[50]]=p[ZC._[50]]||{},p[ZC._[50]].visible=!1,p[ZC._[51]]=p[ZC._[51]]||{},p[ZC._[51]].visible=!1,p[ZC._[51]].zooming=!0,p[ZC._[51]]["min-value"]=0,p[ZC._[51]]["max-value"]=M,p[ZC._[51]].step=M/100,p[ZC._[51]].normalize=!1,p.zoom=p.zoom||{},p.tooltip=p.tooltip||{},p.tooltip.align=ZC._c_(p.tooltip.align,"left"),p.plot=p.plot||{},p.plot.aspect="histogram",p.plot["bar-width"]="100%",p.plot["bars-overlap"]="100%",p.plot.tolerance=-5,p.plot["fast-rules"]=!0,p.plot.alpha=ZC._c_(p.plot.alpha,1),p.plot[ZC._[62]]=ZC._c_(p.plot[ZC._[62]],1),p.plot[ZC._[61]]=ZC._c_(p.plot[ZC._[61]],"#cccccc"),p.plot["border-alpha"]=ZC._c_(p.plot["border-alpha"],.2),p.plot[ZC._[17]]=p.plot[ZC._[17]]||{},p.plot[ZC._[17]]["js-rule"]="zingchart.plugins.flame.valueBoxJsRule()",p.plot[ZC._[17]]["tooltip-text"]=ZC._c_(p.plot[ZC._[17]]["tooltip-text"],'<span style="font-size:13px">%plot-text</span><br/>Value:%node-value (%data-pc-value%)'),p.plot[ZC._[17]].text=ZC._c_(p.plot[ZC._[17]].text,"%data-vbtext"),p.plot[ZC._[17]][ZC._[7]]=ZC._c_(p.plot[ZC._[17]][ZC._[7]],"bottom-in"),p.plot[ZC._[17]].align=ZC._c_(p.plot[ZC._[17]].align,"left"),p.plot[ZC._[17]].color=ZC._c_(p.plot[ZC._[17]].color,"#000000"),p.plot[ZC._[17]]["font-size"]=ZC._c_(p.plot[ZC._[17]]["font-size"],11),p.plot[ZC._[17]]["font-weight"]=ZC._c_(p.plot[ZC._[17]]["font-weight"],"normal"),p.plot[ZC._[17]].tolerance=[0,0,0,0],p.plot[ZC._[17]].angle=ZC._c_(p.plot[ZC._[17]].angle,"flame"===r?0:90),delete p.options,delete p[ZC._[11]],p[ZC._[11]]=[],u=0;u<=f;u++){var V=0,X=-1;for(y=0;y<z[u].length;y++){var R=h[z[u][y]].text,E=R,G=h[z[u][y]].id,I=h[z[u][y]]["up-parent"]||h[z[u][y]].parent;0===u&&(""!==I||1===g&&1<H[t.id].length&&-1!==ZC.AV(H[t.id],G))&&(E="\u25b2 "+E),F={"data-l0items":g,"data-parent":I,"data-uid":G,"data-level":h[z[u][y]].level,"data-plottype":r,"data-vbtext":E,"data-vbfontsize":p.plot[ZC._[17]]["font-size"],"data-value":h[z[u][y]][ZC._[9]],"data-percent":(h[z[u][y]][ZC._[9]]/M*100).toFixed(2),"data-local-value":h[z[u][y]][ZC._[9]],"data-local-percent":(h[z[u][y]][ZC._[9]]/M*100).toFixed(2),"data-offset":V,"-tooltip-text":'<span style="font-size:19px">%data-vbtext</span><br>Value:%data-value (%data-percent%)',"tooltip-text":'<span style="font-size:19px">%data-vbtext</span><br>Value:%data-local-value (%data-local-percent%)',text:R,"offset-values":[V],values:[[h[z[u][y]].level,h[z[u][y]][ZC._[9]]]],"background-color":h[z[u][y]].color,"hover-state":{"background-color":ZC.AO.JR(h[z[u][y]].color,20)}},V+=h[z[u][y]][ZC._[9]],h[z[u][y]].fake&&(F.visible=!1),h[z[u][y]].fake?-1===X?(p[ZC._[11]].push(F),X=p[ZC._[11]].length-1):p[ZC._[11]][X][ZC._[5]][0][1]+=F[ZC._[5]][0][1]:(X=-1,p[ZC._[11]].push(F))}}}return e}),zingchart.plugins.flame.onNodeClick=function(t){var e=zingchart.getLoader(t.id);if(e&&0===t.ev.button){var a=zingchart.getGraph(e,t.graphid);if(a&&("flame"===a.o["plugin-type"]||"vflame"===a.o["plugin-type"])){for(var l=0;l<a.AY.A4.length;l++)a.AY.A4[l].K5["local-value"]=Math.min(t[ZC._[9]],a.AY.A4[l].K5[ZC._[9]]),a.AY.A4[l].K5["local-percent"]=Math.min(100,100*a.AY.A4[l].K5[ZC._[9]]/t[ZC._[9]]).toFixed(2);zingchart.exec(t.id,"zoomto",{graphid:t.graphid,ymin:t["data-offset"],ymax:t["data-offset"]+t[ZC._[9]]})}}},zingchart.bind(null,"node_click",zingchart.plugins.flame.onNodeClick),zingchart.plugins.flame.valueBoxJsRule=function(t){var e=zingchart.getLoader(t.id),e=zingchart.getGraph(e,t.graphid).P,a={visible:!1},l=t.width,o=t.height,l=t.x<=e.iX?t.x+t.width>=e.iX+e.I?e.I:t.width-(e.iX-t.x):t.x+t.width<=e.iX+e.I?t.width:e.iX-e.I-t.x,o=t.y<=e.iY?t.y+t.height>=e.iY+e.F?e.F:t.height-(e.iY-t.y):t.y+t.height<=e.iY+e.F?t.height:e.iY-e.F-t.y,e="flame"===t["data-plottype"]?l:o;return 40<=e&&(a.visible=!0,t["data-vbtext"]=t["data-vbtext"]||"",(l=Math.round(e/(.7*t["data-vbfontsize"])))>=t["data-vbtext"].length?a.text=t["data-vbtext"]:a.text=t["data-vbtext"].substring(0,l-3)+"..."),a}}();